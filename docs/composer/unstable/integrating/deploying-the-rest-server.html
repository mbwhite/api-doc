<!doctype html>
<html lang="en">
  
  
  

<head>
  <meta charset="utf-8">
  
    <title>Deploying the REST server for a business network | Hyperledger Composer</title>
  
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/x-icon" href="/api-doc/composer/unstable/favicon.ico">
  <meta name="google-site-verification" content="fBQRJ6h7MV7_TJ7grbgq4P-d-07NRfDWPe4pqEEoH5w">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  
    <!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-91314349-2', 'auto');
ga('require', 'outboundLinkTracker');
ga('require', 'eventTracker');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src="/api-doc/composer/unstable/assets/js/autotrack.js"></script>
<!-- End Google Analytics -->

  

  
    <link href="/api-doc/composer/unstable/assets/css/normalize.css" rel="stylesheet">
    <link href="/api-doc/composer/unstable/assets/css/new-style.min.css" rel="stylesheet">
    <link href="/api-doc/composer/unstable/assets/css/grid-layout.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
  
</head>


<body class="">

  
  <!-- % include navbar.html % -->
  

  <div class="SiteWrapper">
    
      <div class="content">
    <article class="docs-container">
        <!-- If there's a sidebar, divide into 2 columns -->
        
        <div class="page-sidebar-grid" id="off-canvas">
          <!-- <a class="toggle close" href="#">close</a> -->
          <div class="docs-pagenav-grid">
            <!-- Navigation -->
  <nav class="navbar-docs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
            <a class="navbar-brand" href="/api-doc/composer/unstable/index.html"><b>Hyperledger</b> Composer</a>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <div class="top-nav-docs">
                <!-- <li>
                    <a href="services.html">Composer</a>
                </li> -->
                <!-- <li>
                    <a href="https://composer-playground.mybluemix.net/">Playground</a>
                </li> -->
                    <a href="../tutorials/tutorials.html">Tutorials</a>
                    <a href="../introduction/introduction.html">Docs</a>
                    <a href="../support/support-index.html">Community</a>
            </div>
        </div>
</nav>

          </div>

            <div class="search-form">
              <form action="/api-doc/composer/unstable/search/search.html" method="get">
                <!-- <label for="search-box">Search</label> -->

                <input type="text" id="search-box"  class="search-box" name="query" placeholder="Search here...">
                <input type="submit" class="submit-input hide" value="">

                <div class="search-icon">
                  <img src="/api-doc/composer/unstable/assets/img/Search_Icon_1.svg" class="trigger" type="submit">
                </div>
              </form>
            </div>

          <div class="docs-current-page-grid">
          <p>Deploying the REST server for a business network</p>
          </div>

          <nav class="context-nav">
            
            
              <ul>
<li><p><a href="../introduction/introduction.html"><b>Introduction</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../introduction/key-concepts.html">Key Concepts</a></li>
<li><a href="../introduction/solution-architecture.html">Typical Solution Architecture</a></li>
</ul></li>
<li><p><a href="../installing/installing-index.html"><b>Installing</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../installing/getting-started-with-playground.html">Using the Playground online</a></li>
<li><a href="../installing/prereqs-mac.html">Installing pre-requisites on Mac OS</a></li>
<li><a href="../installing/using-playground-locally.html">Installing the Playground locally</a></li>
<li><a href="../installing/development-tools.html">Installing a development environment</a></li>
</ul></li>
<li><p><a href="../tutorials/tutorials.html"><b>Tutorials</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../tutorials/playground-tutorial.html">Playground Tutorial</a></li>
<li><a href="../tutorials/developer-tutorial.html">Developer Tutorial</a></li>
<li><a href="../tutorials/queries.html">Queries Tutorial</a></li>
<li><a href="../tutorials/deploy-to-fabric-single-org.html">Deploying to a single organization Hyperledger Fabric</a></li>
<li><a href="../tutorials/deploy-to-fabric-multi-org.html">Deploying to a multi-organization Hyperledger Fabric</a></li>
</ul></li>
<li><p><a href="../playground/playground-index.html"><b>Using Playground</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../playground/id-cards-playground.html">Business Network Cards</a></li>
</ul></li>
<li><p><a href="../business-network/business-network-index.html"><b>Developing Business Networks</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../business-network/businessnetworkdefinition.html">Business Network Definitions</a></li>
<li><a href="../business-network/bnd-create.html">Create a Business Network Definition</a></li>
<li><a href="../business-network/bnd-deploy.html">Deploying Business Networks</a></li>
<li><a href="../business-network/publishing-events.html">Emitting Events</a></li>
<li><a href="../business-network/testing.html">Testing Business Networks</a></li>
<li><a href="../business-network/bnd-publish.html">Publish Models or Business Network Definitions</a></li>
<li><a href="../business-network/query.html">Using Queries and Filters with Business Network Data</a></li>
<li><a href="../business-network/programmatic-access-control.html">Programmatic access control</a></li>
<li><a href="../business-network/historian.html">Hyperledger Composer Historian</a></li>
</ul></li>
<li><p><a href="../applications/applications-index.html"><b>Developing Applications</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../applications/node.html">Writing a Node.js application</a></li>
<li><a href="../applications/web.html">Writing Web or mobile applications</a></li>
<li><a href="../applications/subscribing-to-events.html">Subscribing to events</a></li>
</ul></li>
<li><p><a href="../integrating/integrating-index.html"><b>Integrating Existing Systems</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../integrating/getting-started-rest-api.html">Generating a REST API</a></li>
<li><a href="../integrating/publishing-events.html">Publishing events from the REST server</a></li>
<li><a href="../integrating/enabling-rest-authentication.html">Enabling authentication for the REST server</a></li>
<li><a href="../integrating/enabling-multiuser.html">Enabling multiple user mode for the REST server</a></li>
<li><a href="../integrating/securing-the-rest-server.html">Securing the REST server using HTTPS and TLS</a></li>
<li><a href="../integrating/deploying-the-rest-server.html">Deploying the REST server for a business network</a></li>
<li><a href="../integrating/node-red.html">Integrating with Node-RED</a></li>
<li><a href="../integrating/call-out.html">Calling external REST services</a></li>
</ul></li>
<li><p><a href="../managing/managingindex.html"><b>Managing a Deployed Business Network</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../managing/participantsandidentities.html">Participants and identities</a></li>
<li><a href="../managing/participant-add.html">Adding participants</a></li>
<li><a href="../managing/id-cards-playground.html">Creating, Exporting, and Importing Business Network Cards</a></li>
<li><a href="../managing/identity-issue.html">Issuing a new identity to a participant</a></li>
<li><a href="../managing/identity-bind.html">Binding an existing identity to a participant</a></li>
<li><a href="../managing/identity-list.html">Listing all identities in a business network</a></li>
<li><a href="../managing/identity-revoke.html">Revoking an identity from a participant</a></li>
<li><a href="../managing/updating-composer.html">Updating the Hyperledger Composer Runtime</a></li>
</ul></li>
<li><p><a href="../problems/diagnostics.html"><b>Diagnosing Problems</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
<li><p><a href="../reference/reference-index.html"><b>Reference</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../reference/MeetTheModules.html">Hyperledger Composer npm Modules</a></li>
<li><a href="../reference/cto_language.html">Modeling Language</a></li>
<li><a href="../reference/acl_language.html">Access Control Language</a></li>
<li><a href="../reference/query-language.html">Query Language</a></li>
<li><a href="../reference/model-compatibility.html">Model Compatibility</a></li>
<li><a href="../reference/connectionprofile.html">Connection Profiles</a></li>
<li><a href="../reference/js_scripts.html">Transaction Processor Functions</a></li>
<li><a href="../reference/commands.html">Hyperledger Composer CLI Commands</a></li>
<li><a href="../reference/glossary.html">Hyperledger Composer Glossary of Terms</a></li>
</ul></li>
<li><p><a href="../support/support-index.html"><b>Support</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
<li><p><a href="../api/api-doc-index.html"><b>API Reference</b><img src="/api-doc/composer/unstable/assets/img/Caret_SW_2.svg" class="caret"></a></p>

<ul>
<li><a href="../api/allData.html">API Class Index</a></li>
<li><a href="../api/admin-adminconnection.html">AdminConnection (Admin API)</a></li>
<li><a href="../api/client-assetregistry.html">AssetRegistry (Client API)</a></li>
<li><a href="../api/client-businessnetworkconnection.html">BusinessNetworkConnection (Client API)</a></li>
<li><a href="../api/client-historian.html">Historian (Client API)</a></li>
<li><a href="../api/client-identityregistry.html">IdentityRegistry (Client API)</a></li>
<li><a href="../api/client-participantregistry.html">ParticipantRegistry (Client API)</a></li>
<li><a href="../api/client-query.html">Query (Client API)</a></li>
<li><a href="../api/client-registry.html">Registry (Client API)</a></li>
<li><a href="../api/client-transactionregistry.html">TransactionRegistry (Client API)</a></li>
<li><a href="../api/common-baseexception.html">BaseException (Common API)</a></li>
<li><a href="../api/common-basefileexception.html">BaseFileException (Common API)</a></li>
<li><a href="../api/common-businessnetworkcardstore.html">BusinessNetworkCardStore (Common API)</a></li>
<li><a href="../api/common-businessnetworkdefinition.html">BusinessNetworkDefinition (Common API)</a></li>
<li><a href="../api/common-businessnetworkmetadata.html">BusinessNetworkMetadata (Common API)</a></li>
<li><a href="../api/common-concept.html">Concept (Common API)</a></li>
<li><a href="../api/common-factory.html">Factory (Common API)</a></li>
<li><a href="../api/common-idcard.html">IdCard (Common API)</a></li>
<li><a href="../api/common-identifiable.html">Identifiable (Common API)</a></li>
<li><a href="../api/common-introspector.html">Introspector (Common API)</a></li>
<li><a href="../api/common-relationship.html">Relationship (Common API)</a></li>
<li><a href="../api/common-resource.html">Resource (Common API)</a></li>
<li><a href="../api/common-serializer.html">Serializer (Common API)</a></li>
<li><a href="../api/common-typed.html">Typed (Common API)</a></li>
<li><a href="../api/common-validatedconcept.html">ValidatedConcept (Common API)</a></li>
<li><a href="../api/common-validatedresource.html">ValidatedResource (Common API)</a></li>
<li><a href="../api/runtime-api.html">Api (Runtime API)</a></li>
<li><a href="../api/runtime-assetregistry.html">AssetRegistry (Runtime API)</a></li>
<li><a href="../api/runtime-factory.html">Factory (Runtime API)</a></li>
<li><a href="../api/runtime-participantregistry.html">ParticipantRegistry (Runtime API)</a></li>
<li><a href="../api/runtime-query.html">Query (Runtime API)</a></li>
<li><a href="../api/runtime-serializer.html">Serializer (Runtime API)</a></li>
<li><a href="../api/undefined-filewallet.html">FileWallet ( API)</a></li>
<li><a href="../api/undefined-wallet.html">Wallet ( API)</a></li>
</ul></li>
</ul>

            
                <div class="docs-footer-grid">
                <div class="footer-bg-break docs-footer-break">
<div class="footer-container-break">
    <div class="footer-left-break">
      <p>Released under the Apache License v2.0</p>
    </div>
  <div class="footer-right-break">
    <ul>
      <li><a href="https://github.com/hyperledger/composer">GitHub</a></li>
      <li><a href="http://stackoverflow.com/questions/tagged/fabric-composer">Stack Overflow</a></li>
      <li><a href="https://goo.gl/forms/7YPMLP2LTN2hjIRk2">Feedback?</a></li>
    </ul>
  </div>
</div>
</div>

                </div>
          </nav>
        </div>
        <div class="page-content-grid">
          <section class="content-chunk">
            <!-- <a class="toggle open" href="#nav">open</a> -->
            
              <h1 id="deploying-the-rest-server-for-a-business-network">Deploying the REST server for a business network</h1>

<hr>

<p>When deploying the Hyperledger Composer REST server in a production environment, for example using Docker Swarm or Kubernetes, the REST server should be configured to be highly available. This means that you must deploy multiple instances of the REST server, and those instances should be configured to share data. For example, data such as connection profiles, Blockchain identities, and REST API authentication settings should be shared so that a REST API client can make a request to any of the instances without having to reauthenticate.</p>

<h2 id="configuring-the-rest-server-with-a-persistent-data-store">Configuring the REST server with a persistent data store</h2>

<p>All user information is persisted in a LoopBack data source by using a LoopBack connector. By default, the REST server uses the LoopBack &quot;memory&quot; connector to persist user information, which is lost when the REST server is terminated. The REST server should be configured with a LoopBack connector that stores data in a highly available data source, for example a database.</p>

<p>You should be able to use any LoopBack connector, but we recommend that you use a LoopBack connector for a NoSQL database. For example, MongoDB or Apache CouchDB.</p>

<p>The LoopBack connector needs to be installed in order for the REST server to locate and use it. You can install additional LoopBack connectors by using <code>npm</code>, for example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">npm install -g loopback-connector-mongodb
</code></pre></div>
<p>Finally, you need to supply the REST server with the connection information required by the LoopBack connector. This connection information should be supplied by using the <code>COMPOSER_DATASOURCES</code> environment variable. For more information, see below.</p>

<h2 id="configuring-the-rest-server-using-environment-variables">Configuring the REST server using environment variables</h2>

<p>The REST server can be configured using environment variables, instead of supplying configuration options via the command line. The REST server supports the following environment variables:</p>

<ol>
<li><p><code>COMPOSER_CONFIG</code></p>

<p>You can use the <code>COMPOSER_CONFIG</code> environment variable to supply connection profiles to the REST server.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_CONFIG='{
  "connectionProfiles": {
    "hlfv1": {
      "name": "hlfv1",
      "description": "Hyperledger Fabric v1.0",
      "type": "hlfv1",
      "keyValStore": "/home/composer/.composer-credentials",
      "timeout": 300,
      "orderers": [
        {
          "url": "grpc://orderer.example.com:7050"
        }
      ],
      "channel": "composerchannel",
      "mspID": "Org1MSP",
      "ca": {
        "url": "http://ca.org1.example.com:7054",
        "name": "ca.org1.example.com"
      },
      "peers": [
        {
          "requestURL": "grpc://peer0.org1.example.com:7051",
          "eventURL": "grpc://peer0.org1.example.com:7053"
        }
      ]
    }
  }
}'
</code></pre></div></li>
<li><p><code>COMPOSER_CONNECTION_PROFILE</code></p>

<p>You can use the <code>COMPOSER_CONNECTION_PROFILE</code> environment variable to specify the name of the connection profile that the REST server should use.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_CONNECTION_PROFILE=hlfv1
</code></pre></div></li>
<li><p><code>COMPOSER_BUSINESS_NETWORK</code></p>

<p>You can use the <code>COMPOSER_BUSINESS_NETWORK</code> environment variable to specify the name of the deployed business network that the REST server should connect to.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_BUSINESS_NETWORK=my-network
</code></pre></div></li>
<li><p><code>COMPOSER_ENROLLMENT_ID</code></p>

<p>You can use the <code>COMPOSER_ENROLLMENT_ID</code> environment variable to specify the enrollment ID of the Blockchain identity that the REST server should use to connect to the deployed business network.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_ENROLLMENT_ID=loopback1
</code></pre></div></li>
<li><p><code>COMPOSER_ENROLLMENT_SECRET</code></p>

<p>You can use the <code>COMPOSER_ENROLLMENT_SECRET</code> environment variable to specify the enrollment secret of the Blockchain identity that the REST server should use to connect to the deployed business network.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_ENROLLMENT_SECRET=RVsigkBwXrDv
</code></pre></div></li>
<li><p><code>COMPOSER_NAMESPACES</code></p>

<p>You can use the <code>COMPOSER_NAMESPACES</code> environment variable to specify if the REST server should generate a REST API with namespaces or not. Valid values are <code>always</code>, <code>required</code>, and <code>never</code>.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_NAMESPACES=never
</code></pre></div></li>
<li><p><code>COMPOSER_AUTHENTICATION</code></p>

<p>You can use the <code>COMPOSER_AUTHENTICATION</code> environment variable to specify if the REST server should enable REST API authentication or not. Valid values are <code>true</code> and <code>false</code>.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_AUTHENTICATION=true
</code></pre></div>
<p>For more information, see <a href="./enabling-rest-authentication.html">Enabling authentication for the REST server</a>.</p></li>
<li><p><code>COMPOSER_MULTIUSER</code></p>

<p>You can use the <code>COMPOSER_MULTIUSER</code> environment variable to specify if the REST server should enable multiple user mode or not. Valid values are <code>true</code> and <code>false</code>.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_MULTIUSER=true
</code></pre></div>
<p>For more information, see <a href="./enabling-multiuser.html">Enabling multiple user mode for the REST server</a>.</p></li>
<li><p><code>COMPOSER_DATASOURCES</code></p>

<p>You can use the <code>COMPOSER_DATASOURCES</code> environment variable to specify the LoopBack data sources and the connection information required by the selected LoopBack connector.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_DATASOURCES='{
  "db": {
    "name": "db",
    "connector": "mongodb",
    "host": "mongo"
  }
}'
</code></pre></div></li>
<li><p><code>COMPOSER_PROVIDERS</code></p>

<p>You can use the <code>COMPOSER_PROVIDERS</code> environment variable to specify the Passport strategies that the REST server should use to authenticate clients of the REST API.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_PROVIDERS='{
  "github": {
    "provider": "github",
    "module": "passport-github",
    "clientID": "REPLACE_WITH_CLIENT_ID",
    "clientSecret": "REPLACE_WITH_CLIENT_SECRET",
    "authPath": "/auth/github",
    "callbackURL": "/auth/github/callback",
    "successRedirect": "/",
    "failureRedirect": "/"
  }
}'
</code></pre></div></li>
<li><p><code>COMPOSER_TLS</code></p>

<p>You can use the <code>COMPOSER_TLS</code> environment variable to specify if the REST server should enable HTTPS and TLS. Valid values are <code>true</code> and <code>false</code>.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_TLS=true
</code></pre></div>
<p>For more information, see <a href="./securing-the-rest-server.html">Securing the REST server using HTTPS and TLS</a>.</p></li>
<li><p><code>COMPOSER_TLS_CERTIFICATE</code></p>

<p>You can use the <code>COMPOSER_TLS_CERTIFICATE</code> environment variable to specify the certificate file that the REST server should use when HTTPS and TLS are enabled.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_TLS_CERTIFICATE=/tmp/cert.pem
</code></pre></div></li>
<li><p><code>COMPOSER_TLS_KEY</code></p>

<p>You can use the <code>COMPOSER_TLS_KEY</code> environment variable to specify the private key file that the REST server should use when HTTPS and TLS are enabled.</p>

<p>For example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_TLS_KEY=/tmp/key.pem
</code></pre></div></li>
</ol>

<h2 id="packaging-the-rest-server-with-additional-node-js-modules">Packaging the REST server with additional Node.js modules</h2>

<p>In order to deploy the REST server as a Docker container with additional LoopBack connectors and Passport strategies, you must extend the <code>hyperledger/composer-rest-server</code> Docker image.</p>

<p>Here is an example Dockerfile that adds the LoopBack connector for MongoDB and the Passport strategy for GitHub to the Docker image:</p>
<div class="highlight"><pre><code class="language-" data-lang="">FROM hyperledger/composer-rest-server
RUN npm install --production loopback-connector-mongodb passport-github &amp;&amp; \
    npm cache clean &amp;&amp; \
    ln -s node_modules .node_modules
</code></pre></div>
<p>You can build this Docker image by placing the Dockerfile above into a directory and using the <code>docker build</code> command, for example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">docker build -t myorg/my-composer-rest-server .
</code></pre></div>
<p>You may need to publish this Docker image to a Docker image repository, for example Docker Hub, in order to use it with cloud based Docker deployment services.</p>

<h2 id="deploying-a-persistent-and-secured-rest-server-using-docker">Deploying a persistent and secured REST server using Docker</h2>

<p>The following example will demonstrate how to deploy the REST server using Docker. The deployed REST server will persist data using MongoDB, and will be secured using GitHub authentication.</p>

<p>The examples are based on the business network that is deployed to Hyperledger Fabric v1.0 as part of the Developer Tutorial, and may need adjusting for your configuration, for example if the Docker network name does not match.</p>

<ol>
<li><p>Start an instance of MongoDB:</p>
<div class="highlight"><pre><code class="language-" data-lang="">docker run -d --name mongo --network composer_default -p 27017:27017 mongo
</code></pre></div></li>
<li><p>Create a new, empty directory. Create a new file named <code>Dockerfile</code> in the new directory, with the following contents:</p>
<div class="highlight"><pre><code class="language-" data-lang="">FROM hyperledger/composer-rest-server
RUN npm install --production loopback-connector-mongodb passport-github &amp;&amp; \
    npm cache clean &amp;&amp; \
    ln -s node_modules .node_modules
</code></pre></div></li>
<li><p>Change into the directory created in step 2, and build the Docker image:</p>
<div class="highlight"><pre><code class="language-" data-lang="">docker build -t myorg/my-composer-rest-server .
</code></pre></div></li>
<li><p>Create a new file named <code>envvars.txt</code>, with the following contents:</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_CONNECTION_PROFILE=hlfv1
COMPOSER_BUSINESS_NETWORK=my-network
COMPOSER_ENROLLMENT_ID=admin
COMPOSER_ENROLLMENT_SECRET=adminpw
COMPOSER_NAMESPACES=never
COMPOSER_AUTHENTICATION=true
COMPOSER_MULTIUSER=true
COMPOSER_CONFIG='{
  "connectionProfiles": {
    "hlfv1": {
      "name": "hlfv1",
      "description": "Hyperledger Fabric v1.0",
      "type": "hlfv1",
      "keyValStore": "/home/composer/.composer-credentials",
      "timeout": 300,
      "orderers": [
        {
          "url": "grpc://orderer.example.com:7050"
        }
      ],
      "channel": "composerchannel",
      "mspID": "Org1MSP",
      "ca": {
        "url": "http://ca.org1.example.com:7054",
        "name": "ca.org1.example.com"
      },
      "peers": [
        {
          "requestURL": "grpc://peer0.org1.example.com:7051",
          "eventURL": "grpc://peer0.org1.example.com:7053"
        }
      ]
    }
  }
}'
COMPOSER_DATASOURCES='{
  "db": {
    "name": "db",
    "connector": "mongodb",
    "host": "mongo"
  }
}'
COMPOSER_PROVIDERS='{
  "github": {
      "provider": "github",
      "module": "passport-github",
      "clientID": "REPLACE_WITH_CLIENT_ID",
      "clientSecret": "REPLACE_WITH_CLIENT_SECRET",
      "authPath": "/auth/github",
      "callbackURL": "/auth/github/callback",
      "successRedirect": "/",
      "failureRedirect": "/"
  }
}'
</code></pre></div></li>
<li><p>Load the environment variables:</p>
<div class="highlight"><pre><code class="language-" data-lang="">source envvars.txt
</code></pre></div></li>
<li><p>Start the Docker container:</p>
<div class="highlight"><pre><code class="language-" data-lang="">docker run \
    -d \
    -e COMPOSER_CONNECTION_PROFILE=${COMPOSER_CONNECTION_PROFILE} \
    -e COMPOSER_BUSINESS_NETWORK=${COMPOSER_BUSINESS_NETWORK} \
    -e COMPOSER_ENROLLMENT_ID=${COMPOSER_ENROLLMENT_ID} \
    -e COMPOSER_ENROLLMENT_SECRET=${COMPOSER_ENROLLMENT_SECRET} \
    -e COMPOSER_NAMESPACES=${COMPOSER_NAMESPACES} \
    -e COMPOSER_AUTHENTICATION=${COMPOSER_AUTHENTICATION} \
    -e COMPOSER_MULTIUSER=${COMPOSER_MULTIUSER} \
    -e COMPOSER_CONFIG="${COMPOSER_CONFIG}" \
    -e COMPOSER_DATASOURCES="${COMPOSER_DATASOURCES}" \
    -e COMPOSER_PROVIDERS="${COMPOSER_PROVIDERS}" \
    --name rest \
    --network composer_default \
    -p 3000:3000 \
    myorg/my-composer-rest-server
</code></pre></div></li>
</ol>

<p>You should now be able to access the persistent and secured REST server using the following URL: <a href="http://localhost:3000/explorer/">http://localhost:3000/explorer/</a>.</p>

<h2 id="run-the-rest-server-in-a-docker-container-with-no-security-eg-dev-test">Run the REST server in a Docker Container - with no security (eg. Dev/Test)</h2>

<p>These steps will run the REST server in a Docker Container with no security, and therefore no need for persistence of identities.  Activity on the REST server will be in the context of the Admin user used to start the REST server.  Running the REST server in this way is generally good for experimentation and learning, but is not likely to be appropriate for production use.</p>

<ol>
<li><p>Pull the Docker Image for the REST Server:</p>
<div class="highlight"><pre><code class="language-" data-lang="">docker pull hyperledger/composer-rest-server
</code></pre></div></li>
<li><p>Create a new file named <code>envvars.txt</code>, with the following contents:
(The values used below will typically work with a Test Fabric created from examples in this documentation, but the value of the <code>COMPOSER_BUSINESS_NETWORK</code> will need to be set correctly.)</p>
<div class="highlight"><pre><code class="language-" data-lang="">COMPOSER_CONNECTION_PROFILE=hlfv1
COMPOSER_BUSINESS_NETWORK=&lt;my-network&gt;
COMPOSER_ENROLLMENT_ID=admin
COMPOSER_ENROLLMENT_SECRET=adminpw
COMPOSER_NAMESPACES=never
COMPOSER_AUTHENTICATION=false
COMPOSER_MULTIUSER=false
COMPOSER_CONFIG='{
  "connectionProfiles": {
    "hlfv1": {
      "name": "hlfv1",
      "description": "Hyperledger Fabric v1.0",
      "type": "hlfv1",
      "keyValStore": "/home/composer/.composer-credentials",
      "timeout": 300,
      "orderers": [
        {
          "url": "grpc://orderer.example.com:7050"
        }
      ],
      "channel": "composerchannel",
      "mspID": "Org1MSP",
      "ca": {
        "url": "http://ca.org1.example.com:7054",
        "name": "ca.org1.example.com"
      },
      "peers": [
        {
          "requestURL": "grpc://peer0.org1.example.com:7051",
          "eventURL": "grpc://peer0.org1.example.com:7053"
        }
      ]
    }
  }
}'
</code></pre></div></li>
<li><p>Load the environment variables:</p>
<div class="highlight"><pre><code class="language-" data-lang="">source envvars.txt
</code></pre></div></li>
<li><p>Start the Docker container:</p>
<div class="highlight"><pre><code class="language-" data-lang="">docker run \
    -d \
    -e COMPOSER_CONNECTION_PROFILE=${COMPOSER_CONNECTION_PROFILE} \
    -e COMPOSER_BUSINESS_NETWORK=${COMPOSER_BUSINESS_NETWORK} \
    -e COMPOSER_ENROLLMENT_ID=${COMPOSER_ENROLLMENT_ID} \
    -e COMPOSER_ENROLLMENT_SECRET=${COMPOSER_ENROLLMENT_SECRET} \
    -e COMPOSER_NAMESPACES=${COMPOSER_NAMESPACES} \
    -e COMPOSER_AUTHENTICATION=${COMPOSER_AUTHENTICATION} \
    -e COMPOSER_MULTIUSER=${COMPOSER_MULTIUSER} \
    -e COMPOSER_CONFIG="${COMPOSER_CONFIG}" \
    -e COMPOSER_DATASOURCES="${COMPOSER_DATASOURCES}" \
    -e COMPOSER_PROVIDERS="${COMPOSER_PROVIDERS}" \
    --name resttest \
    --network composer_default \
    -p 3000:3000 \
    hyperledger/composer-rest-server
</code></pre></div></li>
</ol>

<p>You should now be able to access the persistent and secured REST server using the following URL: <a href="http://localhost:3000/explorer/">http://localhost:3000/explorer/</a>.</p>

<p>For the REST Server to work in this insecure mode, be sure that the environment variables <code>COMPOSER_DATASOURCES</code> and <code>COMPOSER_PROVIDERS</code> are not set to any value.  Also note the importance of the part of the docker run command <code>--network composer_default</code> which enables the REST Server to &#39;find&#39; the various Fabric Servers.</p>

            
          </section>
        </div>
        <!-- Otherwise, have the main content fill all 12 columns... -->
        
      <div class="PageNavigation">
    
    
  </div>
    </article>
</div>
<script>
(function (document) {
    function clipboard_init() {
        var charts = document.querySelectorAll("div.highlight"),
            arr = [],
            i, j, maxItem, pre, btn, el;

        // Make sure we are dealing with an array
        for(i = 0, maxItem = charts.length; i < maxItem; i++) arr.push(charts[i]);

        // Find the UML source element and get the text
        for (i = 0, maxItem = arr.length; i < maxItem; i++) {
            el = arr[i];
            pre = el.childNodes[0];

            pre.id = "hl_code" + i.toString();
            btn = document.createElement('copy-button');
            btn.appendChild(document.createTextNode('Copy'));
            btn.setAttribute("class", "copy-btn");
            btn.setAttribute("data-clipboard-target", "#hl_code" + i.toString());
            el.insertBefore(btn, pre);
        }
        new Clipboard('.copy-btn');
    };

    function onReady(fn) {
        if (document.addEventListener) {
            document.addEventListener('DOMContentLoaded', fn);
        } else {
            document.attachEvent('onreadystatechange', function() {
                if (document.readyState === 'interactive')
                    fn();
            });
        }
    }

    onReady(function(){
        clipboard_init();
    });
})(document);
</script>
<script src="/api-doc/composer/unstable/assets/js/nav.js"></script>
<script src="/api-doc/composer/unstable/assets/js/search_bar.js"></script>

    

    


  </div>
</body>
</html>
