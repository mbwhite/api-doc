<!doctype html>
<html lang="en">
  
  
  

<head>
  <meta charset="utf-8">
  
    <title>Querying Business Network Data | Hyperledger Composer</title>
  
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/x-icon" href="/api-doc/composer/unstable/favicon.ico">
  <meta name="google-site-verification" content="fBQRJ6h7MV7_TJ7grbgq4P-d-07NRfDWPe4pqEEoH5w">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  
    <!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-91314349-2', 'auto');
ga('require', 'outboundLinkTracker');
ga('require', 'eventTracker');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src="/api-doc/composer/unstable/assets/js/autotrack.js"></script>
<!-- End Google Analytics -->

  

  
    <link href="/api-doc/composer/unstable/assets/css/normalize.css" rel="stylesheet">
    <link href="/api-doc/composer/unstable/assets/css/new-style.min.css" rel="stylesheet">
    <link href="/api-doc/composer/unstable/assets/css/grid-layout.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
  
</head>


<body class="">

  
  <!-- % include navbar.html % -->
  

  <div class="SiteWrapper">
    
      <div class="content">
    <article class="docs-container">
        <!-- If there's a sidebar, divide into 2 columns -->
        
        <div class="page-sidebar-grid" id="off-canvas">
          <!-- <a class="toggle close" href="#">close</a> -->
          <div class="docs-pagenav-grid">
            <!-- Navigation -->
  <nav class="navbar-docs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
            <a class="navbar-brand" href="/api-doc/composer/unstable/index.html"><b>Hyperledger</b> Composer</a>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <div class="top-nav-docs">
                <!-- <li>
                    <a href="services.html">Composer</a>
                </li> -->
                <!-- <li>
                    <a href="https://composer-playground.mybluemix.net/">Playground</a>
                </li> -->
                    <a href="../tutorials/tutorials.html">Tutorials</a>
                    <a href="../introduction/introduction.html">Docs</a>
                    <a href="../support/support-index.html">Community</a>
            </div>
        </div>
</nav>

          </div>

          <div class="docs-current-page-grid">
          <p>Querying Business Network Data</p>
          </div>

          <nav class="context-nav">
            
            
              <ul>
<li><p><a href="../introduction/introduction.html">Introduction</a></p>

<ul>
<li><a href="../introduction/key-concepts.html">Key Concepts</a></li>
<li><a href="../introduction/solution-architecture.html">Typical Solution Architecture</a></li>
</ul></li>
<li><p><a href="../installing/installing-index.html">Installing</a></p>

<ul>
<li><a href="../installing/getting-started-with-playground.html">Using the Playground online</a></li>
<li><a href="../installing/prereqs-mac.html">Installing pre-requisites on Mac OS</a></li>
<li><a href="../installing/using-playground-locally.html">Installing the Playground locally</a></li>
<li><a href="../installing/development-tools.html">Installing a development environment</a></li>
</ul></li>
<li><p><a href="../tutorials/tutorials.html">Tutorials</a></p>

<ul>
<li><a href="../tutorials/playground-guide.html">Playground Tutorial</a></li>
<li><a href="../tutorials/developer-guide.html">Developer Guide</a></li>
<li><a href="../tutorials/queries.html">Queries Guide</a></li>
</ul></li>
<li><p><a href="../playground/playground-index.html">Using Playground</a></p>

<ul>
<li><a href="../playground/id-cards-playground.html">ID Cards</a></li>
</ul></li>
<li><p><a href="../business-network/business-network-index.html">Developing Business Networks</a></p>

<ul>
<li><a href="../business-network/businessnetworkdefinition.html">Business Network Definitions</a></li>
<li><a href="../business-network/bnd-create.html">Create a Business Network Definition</a></li>
<li><a href="../business-network/bnd-deploy.html">Deploying and Updating Business Networks</a></li>
<li><a href="../business-network/publishing-events.html">Emitting Events</a></li>
<li><a href="../business-network/testing.html">Testing Business Networks</a></li>
<li><a href="../business-network/bnd-publish.html">Publish Models or Business Network Definitions</a></li>
<li><a href="../business-network/query.html">Querying Business Network Data</a></li>
<li><a href="../business-network/programmatic-access-control.html">Programmatic access control</a></li>
<li><a href="../business-network/historian.html">Hyperledger Composer Historian</a></li>
</ul></li>
<li><p><a href="../applications/applications-index.html">Developing Applications</a></p>

<ul>
<li><a href="../applications/node.html">Writing a Node.js application</a></li>
<li><a href="../applications/web.html">Writing Web or mobile applications</a></li>
<li><a href="../applications/subscribing-to-events.html">Subscribing to events</a></li>
</ul></li>
<li><p><a href="../integrating/integrating-index.html">Integrating Existing Systems</a></p>

<ul>
<li><a href="../integrating/getting-started-rest-api.html">Generating a REST API</a></li>
<li><a href="../integrating/publishing-events.html">Publishing events from the REST server</a></li>
<li><a href="../integrating/enabling-rest-authentication.html">Enabling authentication for the REST server</a></li>
<li><a href="../integrating/enabling-multiuser.html">Enabling multiple user mode for the REST server</a></li>
<li><a href="../integrating/securing-the-rest-server.html">Securing the REST server using HTTPS and TLS</a></li>
<li><a href="../integrating/deploying-the-rest-server.html">Deploying the REST server for a business network</a></li>
<li><a href="../integrating/node-red.html">Integrating with Node-RED</a></li>
<li><a href="../integrating/call-out.html">Calling external REST services</a></li>
</ul></li>
<li><p><a href="../managing/managingindex.html">Managing a Deployed Business Network</a></p>

<ul>
<li><a href="../managing/participantsandidentities.html">Participants and identities</a></li>
<li><a href="../managing/participant-add.html">Adding participants</a></li>
<li><a href="../managing/id-cards-playground.html">Creating, Exporting, and Importing ID Cards</a></li>
<li><a href="../managing/identity-issue.html">Issuing a new identity to a participant</a></li>
<li><a href="../managing/identity-bind.html">Binding an existing identity to a participant</a></li>
<li><a href="../managing/identity-list.html">Listing all identities in a business network</a></li>
<li><a href="../managing/identity-revoke.html">Revoking an identity from a participant</a></li>
<li><a href="../managing/updating-composer.html">Updating the Hyperledger Composer Runtime</a></li>
</ul></li>
<li><p><a href="../problems/diagnostics.html">Diagnosing Problems</a></p>

<ul>
<li><a href="../problems/deployment-local-playground.html">Error using the local Playground</a></li>
</ul></li>
<li><p><a href="../reference/reference-index.html">Reference</a></p>

<ul>
<li><a href="../reference/MeetTheModules.html">Hyperledger Composer npm Modules</a></li>
<li><a href="../reference/cto_language.html">Modeling Language</a></li>
<li><a href="../reference/acl_language.html">Access Control Language</a></li>
<li><a href="../reference/query-language.html">Query Language</a></li>
<li><a href="../reference/model-compatibility.html">Model Compatibility</a></li>
<li><a href="../reference/connectionprofile.html">Connection Profiles</a></li>
<li><a href="../reference/js_scripts.html">Transaction Processor Functions</a></li>
<li><a href="../reference/commands.html">Hyperledger Composer CLI Commands</a></li>
<li><a href="../reference/glossary.html">Hyperledger Composer Glossary of Terms</a></li>
</ul></li>
<li><p><a href="../support/support-index.html">Support</a></p></li>
<li><p><a href="../api-doc/api-doc-index.html">API Reference</a></p>

<ul>
<li><a href="../api-doc/businessnetworkconnection.js.html">Client businessnetworkconnection.js</a></li>
<li><a href="../api-doc/historian.js.html">Client historian.js</a></li>
<li><a href="../api-doc/identityregistry.js.html">Client identityregistry.js</a></li>
<li><a href="../api-doc/registry.js.html">Client registry.js</a></li>
<li><a href="../api-doc/transactionregistry.js.html">Client transactionregistry.js</a></li>
<li><a href="../api-doc/adminconnection.js.html">Admin adminconnection.js</a></li>
<li><a href="../api-doc/assetregistry.js.html">Runtime assetregistry.js</a></li>
<li><a href="../api-doc/factory.js.html">Runtime factory.js</a></li>
<li><a href="../api-doc/participantregistry.js.html">Runtime participantregistry.js</a></li>
<li><a href="../api-doc/query.js.html">Runtime query.js</a></li>
<li><a href="../api-doc/serializer.js.html">Runtime serializer.js</a></li>
<li><a href="../api-doc/businessnetworkdefinition.html">Common businessnetworkdefinition</a></li>
<li><a href="../api-doc/businessnetworkmetadata.html">Common businessnetworkmetadata</a></li>
<li><a href="../api-doc/concept.html">Common concept</a></li>
<li><a href="../api-doc/factory.html">Common factory</a></li>
<li><a href="../api-doc/idcard.html">Common idcard</a></li>
<li><a href="../api-doc/identifiable.html">Common identifiable</a></li>
<li><a href="../api-doc/illegalmodelexception.html">Common illegalmodelexception</a></li>
<li><a href="../api-doc/introspector.html">Common introspector</a></li>
<li><a href="../api-doc/invalidqueryexception.html">Common invalidqueryexception</a></li>
<li><a href="../api-doc/parseexception.html">Common parseexception</a></li>
<li><a href="../api-doc/relationship.html">Common relationship</a></li>
<li><a href="../api-doc/resource.html">Common resource</a></li>
<li><a href="../api-doc/securitycontext.html">Common securitycontext</a></li>
<li><a href="../api-doc/securityexception.html">Common securityexception</a></li>
<li><a href="../api-doc/serializer.html">Common serializer</a></li>
<li><a href="../api-doc/typed.html">Common typed</a></li>
<li><a href="../api-doc/typenotfoundexception.html">Common typenotfoundexception</a></li>
<li><a href="../api-doc/validatedconcept.html">Common validatedconcept</a></li>
<li><a href="../api-doc/validatedresource.html">Common validatedresource</a></li>
<li><a href="../api-doc/validationexception.html">Common validationexception</a></li>
</ul></li>
</ul>

            
                <div class="docs-footer-grid">
                <div class="footer-bg-break docs-footer-break">
<div class="footer-container-break">
    <div class="footer-left-break">
      <p>Released under the Apache License v2.0</p>
    </div>
  <div class="footer-right-break">
    <ul>
      <li><a href="https://github.com/hyperledger/composer">GitHub</a></li>
      <!-- <li><a href="https://github.com/hyperledger/composer/LICENSE.txt">Legal</a></li> -->
      <li><a href="/api-doc/composer/unstable/jsdoc/index.html">APIs</a></li>
      <li><a href="http://stackoverflow.com/questions/tagged/fabric-composer">Stack Overflow</a></li>
      <li><a href="https://goo.gl/forms/7YPMLP2LTN2hjIRk2">Feedback?</a></li>
    </ul>
  </div>
</div>
</div>

                </div>
          </nav>
        </div>
        <div class="page-content-grid">
          <section class="content-chunk">
            <!-- <a class="toggle open" href="#nav">open</a> -->
            
              <h1 id="querying-business-network-data">Querying business network data</h1>

<blockquote>
<p><strong>Warning</strong>: The status of this feature is experimental. You <strong>must</strong> use Hyperledger Composer v0.8 or greater (preferably &#39;latest&#39;) with the Hyperledger Fabric v1.0 GA runtime to use queries. We welcome feedback and comments while we continue to iteratively add query functionality. The API may change, based on the feedback received.</p>
</blockquote>

<p>Queries are used to return data about the blockchain world-state; for example, you could write a query to return all drivers over a specified age, or all drivers with a specific name. The composer-rest-server component exposes named queries via the generated REST API.</p>

<p>Queries are an optional component of a business network definition, written in a single query file (<code>queries.qry</code>).</p>

<p>Note: Queries are supported by the Hyperledger Fabric v1.0, embedded and web runtimes. The query support for the embedded and web runtimes currently has limitations and is unstable. When using the Hyperledger Fabric v1.0 runtime Hyperledger Fabric must be configured to use CouchDB persistence. </p>

<h2 id="types-of-queries">Types of Queries</h2>

<p>Hyperledger Composer supports two types of queries: named queries and dynamic queries. Named queries are specified in the business network definition and are exposed as GET methods by the composer-rest-server component. Dynamic queries may be constructed dynamically at runtime within a Transaction Processor function, or from client code.</p>

<h2 id="writing-named-queries">Writing Named Queries</h2>

<p>Queries must contain a description and a statement. Query descriptions are a string that describe the function of the query. Query statements contain the operators and functions that control the query behavior.</p>

<p>Query descriptions can be any descriptive string. A query statement must include the <code>SELECT</code> operator and can optionally include <code>FROM</code>, <code>WHERE</code>, <code>AND</code>, <code>ORDER BY</code>, <code>SKIP</code>, and <code>LIMIT</code>.</p>

<p>Queries should take the following format:</p>
<div class="highlight"><pre><code class="language-" data-lang="">query Q1{
  description: "Select all drivers older than 65."
  statement:
      SELECT org.acme.Driver
          WHERE (age&gt;65)
}
</code></pre></div>
<h3 id="query-parameters">Query Parameters</h3>

<p>Queries may embed parameters using the <code>_$</code> syntax. Note that query parameters must be primitive types (String, Integer, Double, Long, Boolean, DateTime), a Relationship or an Enumeration.</p>

<p>The named query below is defined in terms of 3 parameters:</p>
<div class="highlight"><pre><code class="language-" data-lang="">query Q18 {
    description: "Select all drivers aged older than PARAM"
    statement:
        SELECT org.acme.Driver
            WHERE (_$ageParam &lt; age)
                ORDER BY [lastName ASC, firstName DESC]
                    LIMIT _$limitParam
                        SKIP _$skipParam
}
</code></pre></div>
<p>Query parameters are automatically exposed via the GET method created for named queries by the composer-rest-server.</p>

<p>For more information on the specifics of the Hyperledger Composer query language, see the <a href="../reference/query-language.html">query language reference documentation</a>.</p>

<h2 id="using-queries">Using Queries</h2>

<p>Queries can be invoked by calling the <em>buildQuery</em> or <em>query</em> APIs. The <em>buildQuery</em> API requires the entire query string to be specified as part of the API input. The <em>query</em> API requires you to specify the name of the query you wish to run.</p>

<p>For more information on the query APIs, see the <a href="../jsdoc/index.html">API documentation</a>.</p>

<h2 id="access-control-for-queries">Access Control for Queries</h2>

<p>When returning the results of a query, your access control rules are applied to the results. Any content which the current user does not have authority to view is stripped from the results.</p>

<p>For example, if the current user sends a query that would return all assets, if they only have authority to view a limited selection of assets, the query would return only that limited set of assets.</p>

            
          </section>
        </div>
        <!-- Otherwise, have the main content fill all 12 columns... -->
        
      <div class="PageNavigation">
    
    
  </div>
    </article>
</div>
<script>
(function (document) {
    function clipboard_init() {
        var charts = document.querySelectorAll("div.highlight"),
            arr = [],
            i, j, maxItem, pre, btn, el;

        // Make sure we are dealing with an array
        for(i = 0, maxItem = charts.length; i < maxItem; i++) arr.push(charts[i]);

        // Find the UML source element and get the text
        for (i = 0, maxItem = arr.length; i < maxItem; i++) {
            el = arr[i];
            pre = el.childNodes[0];

            pre.id = "hl_code" + i.toString();
            btn = document.createElement('copy-button');
            btn.appendChild(document.createTextNode('Copy'));
            btn.setAttribute("class", "copy-btn");
            btn.setAttribute("data-clipboard-target", "#hl_code" + i.toString());
            el.insertBefore(btn, pre);
        }
        new Clipboard('.copy-btn');
    };

    function onReady(fn) {
        if (document.addEventListener) {
            document.addEventListener('DOMContentLoaded', fn);
        } else {
            document.attachEvent('onreadystatechange', function() {
                if (document.readyState === 'interactive')
                    fn();
            });
        }
    }

    onReady(function(){
        clipboard_init();
    });
})(document);
</script>
<script src="/api-doc/composer/unstable/assets/js/nav.js"></script>

    

    


  </div>
</body>
</html>
